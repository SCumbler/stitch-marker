<dom-module id="sm-editor">
  <template>
    <style>
      :host {
        display: none;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }
      
      :host([active]) {
        display: block;
      }
      
      /*canvas {
        display: block;
      }*/
    </style>
    <canvas id="canvas" width="0" height="0"></canvas>
  </template>

  <script>
    class Editor extends Polymer.Element {
      static get is() { return 'sm-editor'; }

      static get config() {
        return {
          properties: {
            active: {
              type: Object,
              reflectToAttribute: true,
              observer: '_activeChanged'
            }
          }
        };
      }

      _activeChanged(value, old) {
        if (value !== null && value !== undefined) {
          if (!this.offsetWidth) {
            console.log('Requesting animation frame.')
            window.requestAnimationFrame(this._render.bind(this));
          } else {
            console.log('Rendering.')
            this._render();
          }

          this._resizeListener = this._render.bind(this);
          window.addEventListener("resize", this._resizeListener);
        } else {
          window.removeEventListener('resize', this._resizeListener);
        }
      }

      _render() {
        const width = this.offsetWidth;
        const height = this.offsetHeight;

        console.log(`width ${width}`)
        console.log(`height ${height}`)

        const canvas = this.$.canvas;

        canvas.width = width;
        canvas.height = height;

        var ctx = canvas.getContext('2d');

        var grd = ctx.createLinearGradient(0, 0, canvas.width, 0);
        grd.addColorStop(0, "black");
        grd.addColorStop(1, "white");

        ctx.fillStyle = grd;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
      }
    }

    customElements.define(Editor.is, Editor);
  </script>
</dom-module>